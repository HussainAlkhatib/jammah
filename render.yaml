services:
  - type: web
    name: jammah
    env: node
    plan: free
    buildCommand: "npm install && npx prisma generate && npm run build"
    startCommand: "npm run start:next"
    envVars:
      - key: DATABASE_URL
        sync: false
      - key: NEXTAUTH_URL
        value: "https://jammah.onrender.com"
      - key: NEXTAUTH_SECRET
        generateValue: true
      - key: GOOGLE_CLIENT_ID
        sync: false
      - key: GOOGLE_CLIENT_SECRET
        sync: false
      - key: EMAIL_SERVER
        sync: false
      - key: EMAIL_FROM
        sync: false
      - key: NEXT_PUBLIC_SOCKET_URL
        fromService:
          type: pserv
          name: jammah-socket
          property: hostport

  - type: pserv # private service for the socket server
    name: jammah-socket
    env: node
    plan: free
    buildCommand: "npm install"
    startCommand: "npm run start:socket"
    envVars:
      - key: DATABASE_URL
        sync: false
